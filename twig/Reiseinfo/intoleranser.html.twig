<script>
	$(document).on('click','li.person .header', function(){
		var person = $(this).parents('li.person');
		var state = person.attr('data-state');
		if( state == 'hidden' ) {			
			person.addClass('selected').attr('data-state', 'visible');
			person.find('.data.row').slideDown();
		} else {
			person.find('.data.row').slideUp(
				function() {
					$(this).parents('li.person').removeClass('selected');
				}
			);
			person.attr('data-state', 'hidden');
		}
	});
</script>

<fieldset>
	<legend>Deltakernes matallergi/-intoleranse <span class="badge badge-info">BETA</span></legend>

	<div class="row">
		<div class="col-xs-12">
			<h3></h3>
			
			<ol class="list-group" id="intoleranser">
				{% for person in personer.med %}
					{% include "js/intoleranse_deltaker.html.twig" %}
				{% endfor %}
			</ol>
		</div>

	</div>

	{#

    <table class="table table-striped" id="tilrettelegg_personer">
        <thead>
            <tr>
                <th>Person</th>
                <th>Intoleranse</th>
            </tr>
        </thead>

        <tbody>
            {% for person in intoleranser.med %}
                <tr>
                    <td>{{ person.getNavn() }}</td>
                    <td>
                        <textarea class="form-control" rows="3" name="intoleranse[{{ person.getId() }}]">{{ person.getSensitivt().getIntoleranse().getTekst() }}</textarea>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="2">
                        Det er ikke registrert intoleranser p√• noen av dine deltakere
                    </td>
                </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td>
                    <label>Registrer intoleranser for en deltaker</label>
                    <select name="person" id="tilrettelegg_person" class="form-control">
                        <option value="false" selected disabled>Velg en person</option>
                        {% for person in intoleranser.uten %}
                            <option value="{{ person.getId() }}" id="tilrettelegg_person_option_{{ person.getId() }}" data-navn="{{ person.getNavn() }}">{{ person.getNavn() }}</option>
                        {% endfor %}
                    </select>
                </td>
                <td>
                    <textarea class="form-control" rows="3" id="tilrettelegg_person_intoleranse">{{ person.getSensitivt().getIntoleranse().getTekst() }}</textarea>
                    <br />
                    <button id="tilrettelegg_person_submit" type="button" class="btn btn-primary">Legg til</button>
                </td>
            </tr>
        </tfoot>
    </table>
	#}
</fieldset>



